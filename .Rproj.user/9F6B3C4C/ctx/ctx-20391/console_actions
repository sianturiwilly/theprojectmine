{
    "type": [
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2
    ],
    "data": [
        "\nR version 4.0.3 (2020-10-10) -- \"Bunny-Wunnies Freak Out\"\nCopyright (C) 2020 The R Foundation for Statistical Computing\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n\nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n'citation()' on how to cite R or R packages in publications.\n\nType 'demo()' for some demos, 'help()' for on-line help, or\n'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n\n",
        "> ",
        "install.packages(\"tidyverse\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/tidyverse_1.3.0.zip'\n",
        "Content type 'application/zip'",
        " length 439972 bytes (429 KB)\n",
        "downloaded 429 KB\n\n",
        "package ‘tidyverse’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "install.packages(\"psych\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/psych_2.0.12.zip'\n",
        "Content type 'application/zip'",
        " length 4789977 bytes (4.6 MB)\n",
        "downloaded 4.6 MB\n\n",
        "package ‘psych’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "install.packages(\"ggridges\")",
        "Error in install.packages : Updating loaded packages\n\nRestarting R session...\n\n",
        "> ",
        "install.packages(\"ggridges\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/ggridges_0.5.3.zip'\n",
        "Content type 'application/zip'",
        " length 2259122 bytes (2.2 MB)\n",
        "downloaded 2.2 MB\n\n",
        "package ‘ggridges’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "install.packages(\"broom.mixed\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/broom.mixed_0.2.6.zip'\n",
        "Content type 'application/zip'",
        " length 4209949 bytes (4.0 MB)\n",
        "downloaded 4.0 MB\n\n",
        "package ‘broom.mixed’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "install.packages(\"viridis\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/viridis_0.5.1.zip'\n",
        "Content type 'application/zip'",
        " length 1866774 bytes (1.8 MB)\n",
        "downloaded 1.8 MB\n\n",
        "package ‘viridis’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "install.packages(\"modelr\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/modelr_0.1.8.zip'\n",
        "Content type 'application/zip'",
        " length 202941 bytes (198 KB)\n",
        "downloaded 198 KB\n\n",
        "package ‘modelr’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "install.packages(\"lme4\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/lme4_1.1-26.zip'\n",
        "Content type 'application/zip'",
        " length 5334929 bytes (5.1 MB)\n",
        "downloaded 5.1 MB\n\n",
        "package ‘lme4’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "install.packages(\"patchwork\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/lenovo/Documents/R/win-library/4.0’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/patchwork_1.1.1.zip'\n",
        "Content type 'application/zip'",
        " length 3240916 bytes (3.1 MB)\n",
        "downloaded 3.1 MB\n\n",
        "package ‘patchwork’ successfully unpacked and MD5 sums checked\nError in install.packages : ERROR: failed to lock directory ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0’ for modifying\nTry removing ‘C:\\Users\\lenovo\\Documents\\R\\win-library\\4.0/00LOCK’\n",
        "> ",
        "library(tidyverse)",
        "\u001B[30m-- \u001B[1mAttaching packages\u001B[22m -------------------------------- tidyverse 1.3.0 --\u001B[39m\n",
        "\u001B[30m\u001B[32mv\u001B[30m \u001B[34mggplot2\u001B[30m 3.3.3     \u001B[32mv\u001B[30m \u001B[34mpurrr  \u001B[30m 0.3.4\n\u001B[32mv\u001B[30m \u001B[34mtibble \u001B[30m 3.0.5     \u001B[32mv\u001B[30m \u001B[34mdplyr  \u001B[30m 1.0.4\n\u001B[32mv\u001B[30m \u001B[34mtidyr  \u001B[30m 1.1.2     \u001B[32mv\u001B[30m \u001B[34mstringr\u001B[30m 1.4.0\n\u001B[32mv\u001B[30m \u001B[34mreadr  \u001B[30m 1.4.0     \u001B[32mv\u001B[30m \u001B[34mforcats\u001B[30m 0.5.1\u001B[39m\n",
        "\u001B[30m-- \u001B[1mConflicts\u001B[22m ----------------------------------- tidyverse_conflicts() --\n\u001B[31mx\u001B[30m \u001B[34mdplyr\u001B[30m::\u001B[32mfilter()\u001B[30m masks \u001B[34mstats\u001B[30m::filter()\n\u001B[31mx\u001B[30m \u001B[34mdplyr\u001B[30m::\u001B[32mlag()\u001B[30m    masks \u001B[34mstats\u001B[30m::lag()\u001B[39m\n",
        "> ",
        "library(psych)",
        "\nAttaching package: ‘psych’\n\n",
        "The following objects are masked from ‘package:ggplot2’:\n\n    %+%, alpha\n\n",
        "> ",
        "library(ggridges)",
        "> ",
        "library(broom.mixed)",
        "Registered S3 method overwritten by 'broom.mixed':\n  method      from \n  tidy.gamlss broom\n",
        "> ",
        "library(viridis)",
        "Loading required package: viridisLite\n",
        "> ",
        "library(modelr)",
        "> ",
        "library(lme4)",
        "Loading required package: Matrix\n",
        "\nAttaching package: ‘Matrix’\n\n",
        "The following objects are masked from ‘package:tidyr’:\n\n    expand, pack, unpack\n\n",
        "> ",
        "library(patchwork)",
        "> ",
        "insurance_df <- read.csv(\"data/insurance.csv\")",
        "> ",
        "insurance_df",
        "    age    sex    bmi children smoker    region   charges\n1    19 female 27.900        0    yes southwest 16884.924\n2    18   male 33.770        1     no southeast  1725.552\n3    28   male 33.000        3     no southeast  4449.462\n4    33   male 22.705        0     no northwest 21984.471\n5    32   male 28.880        0     no northwest  3866.855\n6    31 female 25.740        0     no southeast  3756.622\n7    46 female 33.440        1     no southeast  8240.590\n8    37 female 27.740        3     no northwest  7281.506",
        "\n9    37   male 29.830        2     no northeast  6406.411\n10   60 female 25.840        0     no northwest 28923.137\n11   25   male 26.220        0     no northeast  2721.321\n12   62 female 26.290        0    yes southeast 27808.725\n13   23   male 34.400        0     no southwest  1826.843\n14   56 female 39.820        0     no southeast 11090.718\n15   27   male 42.130        0    yes southeast 39611.758\n16   19   male 24.600        1     no southwest  1837.237\n17   52 female 30.780        1     no northeast",
        " 10797.336\n18   23   male 23.845        0     no northeast  2395.172\n19   56   male 40.300        0     no southwest 10602.385\n20   30   male 35.300        0    yes southwest 36837.467\n21   60 female 36.005        0     no northeast 13228.847\n22   30 female 32.400        1     no southwest  4149.736\n23   18   male 34.100        0     no southeast  1137.011\n24   34 female 31.920        1    yes northeast 37701.877\n25   37   male 28.025        2     no northwest  6203.902\n26   59 female 27.720        3     no",
        " southeast 14001.134\n27   63 female 23.085        0     no northeast 14451.835\n28   55 female 32.775        2     no northwest 12268.632\n29   23   male 17.385        1     no northwest  2775.192\n30   31   male 36.300        2    yes southwest 38711.000\n31   22   male 35.600        0    yes southwest 35585.576\n32   18 female 26.315        0     no northeast  2198.190\n33   19 female 28.600        5     no southwest  4687.797\n34   63   male 28.310        0     no northwest 13770.098\n35   28   male 36.400        1",
        "    yes southwest 51194.559\n36   19   male 20.425        0     no northwest  1625.434\n37   62 female 32.965        3     no northwest 15612.193\n38   26   male 20.800        0     no southwest  2302.300\n39   35   male 36.670        1    yes northeast 39774.276\n40   60   male 39.900        0    yes southwest 48173.361\n41   24 female 26.600        0     no northeast  3046.062\n42   31 female 36.630        2     no southeast  4949.759\n43   41   male 21.780        1     no southeast  6272.477\n44   37 female 30.800",
        "        2     no southeast  6313.759\n45   38   male 37.050        1     no northeast  6079.672\n46   55   male 37.300        0     no southwest 20630.284\n47   18 female 38.665        2     no northeast  3393.356\n48   28 female 34.770        0     no northwest  3556.922\n49   60 female 24.530        0     no southeast 12629.897\n50   36   male 35.200        1    yes southeast 38709.176\n51   18 female 35.625        0     no northeast  2211.131\n52   21 female 33.630        2     no northwest  3579.829\n53   48   male",
        " 28.000        1    yes southwest 23568.272\n54   36   male 34.430        0    yes southeast 37742.576\n55   40 female 28.690        3     no northwest  8059.679\n56   58   male 36.955        2    yes northwest 47496.494\n57   58 female 31.825        2     no northeast 13607.369\n58   18   male 31.680        2    yes southeast 34303.167\n59   53 female 22.880        1    yes southeast 23244.790\n60   34 female 37.335        2     no northwest  5989.524\n61   43   male 27.360        3     no northeast  8606.217\n62   25",
        "   male 33.660        4     no southeast  4504.662\n63   64   male 24.700        1     no northwest 30166.618\n64   28 female 25.935        1     no northwest  4133.642\n65   20 female 22.420        0    yes northwest 14711.744\n66   19 female 28.900        0     no southwest  1743.214\n67   61 female 39.100        2     no southwest 14235.072\n68   40   male 26.315        1     no northwest  6389.378\n69   40 female 36.190        0     no southeast  5920.104\n70   28   male 23.980        3    yes southeast 17663.144",
        "\n71   27 female 24.750        0    yes southeast 16577.780\n72   31   male 28.500        5     no northeast  6799.458\n73   53 female 28.100        3     no southwest 11741.726\n74   58   male 32.010        1     no southeast 11946.626\n75   44   male 27.400        2     no southwest  7726.854\n76   57   male 34.010        0     no northwest 11356.661\n77   29 female 29.590        1     no southeast  3947.413\n78   21   male 35.530        0     no southeast  1532.470\n79   22 female 39.805        0     no northeast",
        "  2755.021\n80   41 female 32.965        0     no northwest  6571.024\n81   31   male 26.885        1     no northeast  4441.213\n82   45 female 38.285        0     no northeast  7935.291\n83   22   male 37.620        1    yes southeast 37165.164\n84   48 female 41.230        4     no northwest 11033.662\n85   37 female 34.800        2    yes southwest 39836.519\n86   45   male 22.895        2    yes northwest 21098.554\n87   57 female 31.160        0    yes northwest 43578.939\n88   56 female 27.200        0     no",
        " southwest 11073.176\n89   46 female 27.740        0     no northwest  8026.667\n90   55 female 26.980        0     no northwest 11082.577\n91   21 female 39.490        0     no southeast  2026.974\n92   53 female 24.795        1     no northwest 10942.132\n93   59   male 29.830        3    yes northeast 30184.937\n94   35   male 34.770        2     no northwest  5729.005\n95   64 female 31.300        2    yes southwest 47291.055\n96   28 female 37.620        1     no southeast  3766.884\n97   54 female 30.800        3",
        "     no southwest 12105.320\n98   55   male 38.280        0     no southeast 10226.284\n99   56   male 19.950        0    yes northeast 22412.648\n100  38   male 19.300        0    yes southwest 15820.699\n101  41 female 31.600        0     no southwest  6186.127\n102  30   male 25.460        0     no northeast  3645.089\n103  18 female 30.115        0     no northeast 21344.847\n104  61 female 29.920        3    yes southeast 30942.192\n105  34 female 27.500        1     no southwest  5003.853\n106  20   male 28.025",
        "        1    yes northwest 17560.380\n107  19 female 28.400        1     no southwest  2331.519\n108  26   male 30.875        2     no northwest  3877.304\n109  29   male 27.940        0     no southeast  2867.120\n110  63   male 35.090        0    yes southeast 47055.532\n111  54   male 33.630        1     no northwest 10825.254\n112  55 female 29.700        2     no southwest 11881.358\n113  37   male 30.800        0     no southwest  4646.759\n114  21 female 35.720        0     no northwest  2404.734\n115  52   male",
        " 32.205        3     no northeast 11488.317\n116  60   male 28.595        0     no northeast 30259.996\n117  58   male 49.060        0     no southeast 11381.325\n118  29 female 27.940        1    yes southeast 19107.780\n119  49 female 27.170        0     no southeast  8601.329\n120  37 female 23.370        2     no northwest  6686.431\n121  44   male 37.100        2     no southwest  7740.337\n122  18   male 23.750        0     no northeast  1705.624\n123  20 female 28.975        0     no northwest  2257.475\n124  44",
        "   male 31.350        1    yes northeast 39556.495\n125  47 female 33.915        3     no northwest 10115.009\n126  26 female 28.785        0     no northeast  3385.399\n127  19 female 28.300        0    yes southwest 17081.080\n128  52 female 37.400        0     no southwest  9634.538\n129  32 female 17.765        2    yes northwest 32734.186\n130  38   male 34.700        2     no southwest  6082.405\n131  59 female 26.505        0     no northeast 12815.445\n132  61 female 22.040        0     no northeast 13616.359",
        "\n133  53 female 35.900        2     no southwest 11163.568\n134  19   male 25.555        0     no northwest  1632.564\n135  20 female 28.785        0     no northeast  2457.211\n136  22 female 28.050        0     no southeast  2155.682\n137  19   male 34.100        0     no southwest  1261.442\n138  22   male 25.175        0     no northwest  2045.685\n139  54 female 31.900        3     no southeast 27322.734\n140  22 female 36.000        0     no southwest  2166.732\n141  34   male 22.420        2     no northeast",
        " 27375.905\n142  26   male 32.490        1     no northeast  3490.549\n [ reached 'max' / getOption(\"max.print\") -- omitted 1196 rows ]\n",
        "> ",
        "insurance_df %>%",
        "+ ",
        "  summarise_all(",
        "+ ",
        "    ~ sum(is.na(.))",
        "+ ",
        "  )",
        "  age sex bmi children smoker region charges\n1   0   0   0        0      0      0       0\n",
        "> ",
        "summary(insurance_df)",
        "      age            sex                 bmi           children    \n Min.   :18.00   Length:1338        Min.   :15.96   Min.   :0.000  \n 1st Qu.:27.00   Class :character   1st Qu.:26.30   1st Qu.:0.000  \n Median :39.00   Mode  :character   Median :30.40   Median :1.000  \n Mean   :39.21                      Mean   :30.66   Mean   :1.095  \n 3rd Qu.:51.00                      3rd Qu.:34.69   3rd Qu.:2.000  \n Max.   :64.00                      Max.   :53.13   Max.   :5.000  \n    smoker             region         ",
        "    charges     \n Length:1338        Length:1338        Min.   : 1122  \n Class :character   Class :character   1st Qu.: 4740  \n Mode  :character   Mode  :character   Median : 9382  \n                                       Mean   :13270  \n                                       3rd Qu.:16640  \n                                       Max.   :63770  \n",
        "> ",
        "insurance_df <- insurance_df %>%",
        "+ ",
        "  mutate(sex = factor(sex),",
        "+ ",
        "         smoker = factor(smoker),",
        "+ ",
        "         region = factor(region),",
        "+ ",
        "         children = factor(children)",
        "+ ",
        "  ) ",
        "> ",
        "insurance_df",
        "    age    sex    bmi children smoker    region   charges\n1    19 female 27.900        0    yes southwest 16884.924\n2    18   male 33.770        1     no southeast  1725.552\n3    28   male 33.000        3     no southeast  4449.462\n4    33   male 22.705        0     no northwest 21984.471\n5    32   male 28.880        0     no northwest  3866.855\n6    31 female 25.740        0     no southeast  3756.622\n7    46 female 33.440        1     no southeast  8240.590\n8    37 female 27.740        3     no northwest  7281.506",
        "\n9    37   male 29.830        2     no northeast  6406.411\n10   60 female 25.840        0     no northwest 28923.137\n11   25   male 26.220        0     no northeast  2721.321\n12   62 female 26.290        0    yes southeast 27808.725\n13   23   male 34.400        0     no southwest  1826.843\n14   56 female 39.820        0     no southeast 11090.718\n15   27   male 42.130        0    yes southeast 39611.758\n16   19   male 24.600        1     no southwest  1837.237\n17   52 female 30.780        1     no northeast",
        " 10797.336\n18   23   male 23.845        0     no northeast  2395.172\n19   56   male 40.300        0     no southwest 10602.385\n20   30   male 35.300        0    yes southwest 36837.467\n21   60 female 36.005        0     no northeast 13228.847\n22   30 female 32.400        1     no southwest  4149.736\n23   18   male 34.100        0     no southeast  1137.011\n24   34 female 31.920        1    yes northeast 37701.877\n25   37   male 28.025        2     no northwest  6203.902\n26   59 female 27.720        3     no",
        " southeast 14001.134\n27   63 female 23.085        0     no northeast 14451.835\n28   55 female 32.775        2     no northwest 12268.632\n29   23   male 17.385        1     no northwest  2775.192\n30   31   male 36.300        2    yes southwest 38711.000\n31   22   male 35.600        0    yes southwest 35585.576\n32   18 female 26.315        0     no northeast  2198.190\n33   19 female 28.600        5     no southwest  4687.797\n34   63   male 28.310        0     no northwest 13770.098\n35   28   male 36.400        1",
        "    yes southwest 51194.559\n36   19   male 20.425        0     no northwest  1625.434\n37   62 female 32.965        3     no northwest 15612.193\n38   26   male 20.800        0     no southwest  2302.300\n39   35   male 36.670        1    yes northeast 39774.276\n40   60   male 39.900        0    yes southwest 48173.361\n41   24 female 26.600        0     no northeast  3046.062\n42   31 female 36.630        2     no southeast  4949.759\n43   41   male 21.780        1     no southeast  6272.477\n44   37 female 30.800",
        "        2     no southeast  6313.759\n45   38   male 37.050        1     no northeast  6079.672\n46   55   male 37.300        0     no southwest 20630.284\n47   18 female 38.665        2     no northeast  3393.356\n48   28 female 34.770        0     no northwest  3556.922\n49   60 female 24.530        0     no southeast 12629.897\n50   36   male 35.200        1    yes southeast 38709.176\n51   18 female 35.625        0     no northeast  2211.131\n52   21 female 33.630        2     no northwest  3579.829\n53   48   male",
        " 28.000        1    yes southwest 23568.272\n54   36   male 34.430        0    yes southeast 37742.576\n55   40 female 28.690        3     no northwest  8059.679\n56   58   male 36.955        2    yes northwest 47496.494\n57   58 female 31.825        2     no northeast 13607.369\n58   18   male 31.680        2    yes southeast 34303.167\n59   53 female 22.880        1    yes southeast 23244.790\n60   34 female 37.335        2     no northwest  5989.524\n61   43   male 27.360        3     no northeast  8606.217\n62   25",
        "   male 33.660        4     no southeast  4504.662\n63   64   male 24.700        1     no northwest 30166.618\n64   28 female 25.935        1     no northwest  4133.642\n65   20 female 22.420        0    yes northwest 14711.744\n66   19 female 28.900        0     no southwest  1743.214\n67   61 female 39.100        2     no southwest 14235.072\n68   40   male 26.315        1     no northwest  6389.378\n69   40 female 36.190        0     no southeast  5920.104\n70   28   male 23.980        3    yes southeast 17663.144",
        "\n71   27 female 24.750        0    yes southeast 16577.780\n72   31   male 28.500        5     no northeast  6799.458\n73   53 female 28.100        3     no southwest 11741.726\n74   58   male 32.010        1     no southeast 11946.626\n75   44   male 27.400        2     no southwest  7726.854\n76   57   male 34.010        0     no northwest 11356.661\n77   29 female 29.590        1     no southeast  3947.413\n78   21   male 35.530        0     no southeast  1532.470\n79   22 female 39.805        0     no northeast",
        "  2755.021\n80   41 female 32.965        0     no northwest  6571.024\n81   31   male 26.885        1     no northeast  4441.213\n82   45 female 38.285        0     no northeast  7935.291\n83   22   male 37.620        1    yes southeast 37165.164\n84   48 female 41.230        4     no northwest 11033.662\n85   37 female 34.800        2    yes southwest 39836.519\n86   45   male 22.895        2    yes northwest 21098.554\n87   57 female 31.160        0    yes northwest 43578.939\n88   56 female 27.200        0     no",
        " southwest 11073.176\n89   46 female 27.740        0     no northwest  8026.667\n90   55 female 26.980        0     no northwest 11082.577\n91   21 female 39.490        0     no southeast  2026.974\n92   53 female 24.795        1     no northwest 10942.132\n93   59   male 29.830        3    yes northeast 30184.937\n94   35   male 34.770        2     no northwest  5729.005\n95   64 female 31.300        2    yes southwest 47291.055\n96   28 female 37.620        1     no southeast  3766.884\n97   54 female 30.800        3",
        "     no southwest 12105.320\n98   55   male 38.280        0     no southeast 10226.284\n99   56   male 19.950        0    yes northeast 22412.648\n100  38   male 19.300        0    yes southwest 15820.699\n101  41 female 31.600        0     no southwest  6186.127\n102  30   male 25.460        0     no northeast  3645.089\n103  18 female 30.115        0     no northeast 21344.847\n104  61 female 29.920        3    yes southeast 30942.192\n105  34 female 27.500        1     no southwest  5003.853\n106  20   male 28.025",
        "        1    yes northwest 17560.380\n107  19 female 28.400        1     no southwest  2331.519\n108  26   male 30.875        2     no northwest  3877.304\n109  29   male 27.940        0     no southeast  2867.120\n110  63   male 35.090        0    yes southeast 47055.532\n111  54   male 33.630        1     no northwest 10825.254\n112  55 female 29.700        2     no southwest 11881.358\n113  37   male 30.800        0     no southwest  4646.759\n114  21 female 35.720        0     no northwest  2404.734\n115  52   male",
        " 32.205        3     no northeast 11488.317\n116  60   male 28.595        0     no northeast 30259.996\n117  58   male 49.060        0     no southeast 11381.325\n118  29 female 27.940        1    yes southeast 19107.780\n119  49 female 27.170        0     no southeast  8601.329\n120  37 female 23.370        2     no northwest  6686.431\n121  44   male 37.100        2     no southwest  7740.337\n122  18   male 23.750        0     no northeast  1705.624\n123  20 female 28.975        0     no northwest  2257.475\n124  44",
        "   male 31.350        1    yes northeast 39556.495\n125  47 female 33.915        3     no northwest 10115.009\n126  26 female 28.785        0     no northeast  3385.399\n127  19 female 28.300        0    yes southwest 17081.080\n128  52 female 37.400        0     no southwest  9634.538\n129  32 female 17.765        2    yes northwest 32734.186\n130  38   male 34.700        2     no southwest  6082.405\n131  59 female 26.505        0     no northeast 12815.445\n132  61 female 22.040        0     no northeast 13616.359",
        "\n133  53 female 35.900        2     no southwest 11163.568\n134  19   male 25.555        0     no northwest  1632.564\n135  20 female 28.785        0     no northeast  2457.211\n136  22 female 28.050        0     no southeast  2155.682\n137  19   male 34.100        0     no southwest  1261.442\n138  22   male 25.175        0     no northwest  2045.685\n139  54 female 31.900        3     no southeast 27322.734\n140  22 female 36.000        0     no southwest  2166.732\n141  34   male 22.420        2     no northeast",
        " 27375.905\n142  26   male 32.490        1     no northeast  3490.549\n [ reached 'max' / getOption(\"max.print\") -- omitted 1196 rows ]\n",
        "> ",
        "insurance_df %>% ",
        "+ ",
        "  ggplot(aes(charges, ..density.., fill = I(\"#d45087\"))) +",
        "+ ",
        "  geom_histogram(bins = 50) +",
        "+ ",
        "  geom_density()+",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "tibble(low_charges = nrow(filter(insurance_df,charges<15000 )),",
        "+ ",
        "       middle_charges =  nrow(filter(insurance_df,charges>=15000 & charges<50000)),",
        "+ ",
        "       high_charges = nrow(filter(insurance_df, charges>=50000)),",
        "+ ",
        ")",
        "\u001B[90m# A tibble: 1 x 3\u001B[39m\n  low_charges middle_charges high_charges\n        \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m          \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m        \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m\n\u001B[90m1\u001B[39m         980            351            7\n",
        "> ",
        "insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, fill = I(\"#d45087\")))+",
        "+ ",
        "  geom_bar()+ ",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, charges))+",
        "+ ",
        "  geom_point(color = I(\"#d45087\"))",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, charges, color = smoker))+",
        "+ ",
        "  geom_point()",
        "> ",
        "",
        "> ",
        "p1+p2",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  count(sex) %>% ",
        "+ ",
        "  ggplot(aes(sex, n, fill = I(\"#d45087\")))+",
        "+ ",
        "  geom_col()+",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(charges, sex, fill = sex)) +",
        "+ ",
        "  ggridges::geom_density_ridges()",
        "> ",
        "",
        "> ",
        "p3 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(sex, charges, fill = sex))+",
        "+ ",
        "  geom_boxplot()",
        "> ",
        "",
        "> ",
        "(p1+p2)/p3",
        "Picking joint bandwidth of 2190\n",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(x = bmi, y = stat(density))) +",
        "+ ",
        "  geom_histogram( aes(fill = I(\"#d45087\")), bins = 50) +",
        "+ ",
        "  theme(legend.position = \"none\") +",
        "+ ",
        "  geom_density()",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(x = bmi, charges, color = charges)) +",
        "+ ",
        "  geom_point() +",
        "+ ",
        "  scale_color_viridis(option = \"E\")",
        "> ",
        "",
        "> ",
        "p3 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(factor(age), bmi, color = I(\"#d45087\"))) +",
        "+ ",
        "  geom_point() +",
        "+ ",
        "  geom_jitter() +",
        "+ ",
        "  stat_summary(fun = mean, colour = \"blue\", geom = \"point\", size = 5)",
        "> ",
        "",
        "> ",
        "(p1+p2)/p3",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  count(children) %>% ",
        "+ ",
        "  ggplot(aes(children, n))+",
        "+ ",
        "  geom_col( aes(fill = I(\"#d45087\")))+",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(children, charges, fill = children))+",
        "+ ",
        "  geom_boxplot()",
        "> ",
        "",
        "> ",
        "p1+p2",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(smoker,charges, fill = smoker))+",
        "+ ",
        "  geom_boxplot()",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>%",
        "+ ",
        "  ggplot(aes(charges, fill = smoker, alpha = 0.5))+",
        "+ ",
        "  geom_density()",
        "> ",
        "",
        "> ",
        "p1/p2",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  count(region) %>% ",
        "+ ",
        "  ggplot(aes(region, n, width = 0.7, fill = I(\"#d45087\")))+",
        "+ ",
        "  geom_col()+",
        "+ ",
        "  coord_flip()+",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(charges, region, fill = region)) +",
        "+ ",
        "  ggridges::geom_density_ridges()",
        "> ",
        "",
        "> ",
        "p3 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(region, charges, fill = region))+",
        "+ ",
        "  geom_boxplot()+",
        "+ ",
        "  coord_flip()",
        "> ",
        "",
        "> ",
        "p1+(p2/p3)",
        "Picking joint bandwidth of 2370\n",
        "> ",
        "outliers_charges <- boxplot.stats(insurance_df$charges)$out",
        "> ",
        "outliers_charges",
        "  [1] 39611.76 36837.47 37701.88 38711.00 35585.58 51194.56 39774.28\n  [8] 48173.36 38709.18 37742.58 47496.49 37165.16 39836.52 43578.94\n [15] 47291.06 47055.53 39556.49 40720.55 36950.26 36149.48 48824.45\n [22] 43753.34 37133.90 34779.61 38511.63 35160.13 47305.31 44260.75\n [29] 41097.16 43921.18 36219.41 46151.12 42856.84 48549.18 47896.79\n [36] 42112.24 38746.36 42124.52 34838.87 35491.64 42760.50 47928.03\n [43] 48517.56 41919.10 36085.22 38126.25 42303.69 46889.26 46599.11\n [50] 39125.33 37079.37 35147.53",
        " 48885.14 36197.70 38245.59 48675.52\n [57] 63770.43 45863.21 39983.43 45702.02 58571.07 43943.88 39241.44\n [64] 42969.85 40182.25 34617.84 42983.46 42560.43 40003.33 45710.21\n [71] 46200.99 46130.53 40103.89 34806.47 40273.65 44400.41 40932.43\n [78] 40419.02 36189.10 44585.46 43254.42 36307.80 38792.69 55135.40\n [85] 43813.87 39597.41 36021.01 45008.96 37270.15 42111.66 40974.16\n [92] 46113.51 46255.11 44202.65 48673.56 35069.37 39047.29 47462.89\n [99] 38998.55 41999.52 41034.22 36580.28 35595.59 42211.14 44423.80",
        "\n[106] 37484.45 39725.52 44501.40 39727.61 48970.25 39871.70 34672.15\n[113] 41676.08 44641.20 41949.24 36124.57 38282.75 46661.44 40904.20\n[120] 36898.73 52590.83 40941.29 39722.75 37465.34 36910.61 38415.47\n[127] 41661.60 60021.40 47269.85 49577.66 37607.53 47403.88 38344.57\n[134] 34828.65 62592.87 46718.16 37829.72 36397.58 43896.38\n",
        "> ",
        "outliers_ind <- which(insurance_df$charges %in% c(outliers_charges))",
        "> ",
        "outliers_ind",
        "  [1]   15   20   24   30   31   35   39   40   50   54   56   83   85\n [14]   87   95  110  124  147  159  162  176  186  204  224  241  243\n [27]  252  253  255  257  264  266  272  282  289  293  299  313  315\n [40]  323  328  329  331  339  374  378  382  421  422  423  442  477\n [53]  489  501  525  531  544  550  559  570  578  588  610  616  622\n [66]  624  630  666  668  669  675  678  683  690  698  707  726  737\n [79]  739  740  743  760  804  820  827  829  843  846  851  853  857\n [92]  861  884",
        "  894  902  918  948  952  954  957  959 1013 1022 1023\n[105] 1032 1037 1038 1048 1050 1063 1071 1079 1091 1097 1112 1118 1119\n[118] 1123 1125 1140 1147 1153 1157 1187 1207 1208 1219 1231 1241 1242\n[131] 1250 1285 1289 1292 1301 1302 1304 1314 1324\n",
        "> ",
        "outliers_data <- insurance_df[outliers_ind, ]",
        "> ",
        "insurance_df[outliers_ind, ]",
        "     age    sex    bmi children smoker    region  charges\n15    27   male 42.130        0    yes southeast 39611.76\n20    30   male 35.300        0    yes southwest 36837.47\n24    34 female 31.920        1    yes northeast 37701.88\n30    31   male 36.300        2    yes southwest 38711.00\n31    22   male 35.600        0    yes southwest 35585.58\n35    28   male 36.400        1    yes southwest 51194.56\n39    35   male 36.670        1    yes northeast 39774.28\n40    60   male 39.900        0    yes southwest",
        " 48173.36\n50    36   male 35.200        1    yes southeast 38709.18\n54    36   male 34.430        0    yes southeast 37742.58\n56    58   male 36.955        2    yes northwest 47496.49\n83    22   male 37.620        1    yes southeast 37165.16\n85    37 female 34.800        2    yes southwest 39836.52\n87    57 female 31.160        0    yes northwest 43578.94\n95    64 female 31.300        2    yes southwest 47291.06\n110   63   male 35.090        0    yes southeast 47055.53\n124   44   male 31.350        1    yes",
        " northeast 39556.49\n147   46   male 30.495        3    yes northwest 40720.55\n159   30   male 35.530        0    yes southeast 36950.26\n162   18 female 36.850        0    yes southeast 36149.48\n176   63 female 37.700        0    yes southwest 48824.45\n186   36   male 41.895        3    yes northeast 43753.34\n204   27 female 36.080        0    yes southeast 37133.90\n224   19   male 34.800        0    yes southwest 34779.61\n241   23 female 36.670        2    yes northeast 38511.63\n243   55 female 26.800        1",
        "     no southwest 35160.13\n252   63 female 32.200        2    yes southwest 47305.31\n253   54   male 34.210        2    yes southeast 44260.75\n255   50   male 31.825        0    yes northeast 41097.16\n257   56   male 33.630        0    yes northwest 43921.18\n264   19   male 36.955        0    yes northwest 36219.41\n266   46   male 42.350        3    yes southeast 46151.12\n272   50   male 34.200        2    yes southwest 42856.84\n282   54   male 40.565        3    yes northeast 48549.18\n289   59 female 36.765",
        "        1    yes northeast 47896.79\n293   25   male 45.540        2    yes southeast 42112.24\n299   31   male 34.390        3    yes northwest 38746.36\n313   43   male 35.970        3    yes southeast 42124.52\n315   27 female 31.400        0    yes southwest 34838.87\n323   34   male 30.800        0    yes southwest 35491.64\n328   45   male 36.480        2    yes northwest 42760.50\n329   64 female 33.800        1    yes southwest 47928.03\n331   61 female 36.385        1    yes northeast 48517.56\n339   50   male",
        " 32.300        1    yes northeast 41919.10\n374   26   male 32.900        2    yes southwest 36085.22\n378   24   male 40.150        0    yes southeast 38126.25\n382   55   male 30.685        0    yes northeast 42303.69\n421   64   male 33.880        0    yes southeast 46889.26\n422   61   male 35.860        0    yes southeast 46599.11\n423   40   male 32.775        1    yes northeast 39125.33\n442   33 female 33.500        0    yes southwest 37079.37\n477   24   male 28.500        0    yes northeast 35147.53\n489   44",
        " female 38.060        0    yes southeast 48885.14\n501   29   male 34.400        0    yes southwest 36197.70\n525   42   male 26.070        1    yes southeast 38245.59\n531   57   male 42.130        1    yes southeast 48675.52\n544   54 female 47.410        0    yes southeast 63770.43\n550   43 female 46.200        0    yes southeast 45863.21\n559   35 female 34.105        3    yes northwest 39983.43\n570   48   male 40.565        2    yes northwest 45702.02\n578   31 female 38.095        1    yes northeast 58571.07",
        "\n588   34 female 30.210        1    yes northwest 43943.88\n610   30   male 37.800        2    yes southwest 39241.44\n616   47 female 36.630        1    yes southeast 42969.85\n622   37   male 34.100        4    yes southwest 40182.25\n624   18   male 33.535        0    yes northeast 34617.84\n630   44 female 38.950        0    yes northwest 42983.46\n666   43   male 38.060        2    yes southeast 42560.43\n668   40 female 32.775        2    yes northwest 40003.33\n669   62   male 32.015        0    yes northeast",
        " 45710.21\n675   44 female 43.890        2    yes southeast 46200.99\n678   60   male 31.350        3    yes northwest 46130.53\n683   39   male 35.300        2    yes southwest 40103.89\n690   27   male 31.130        1    yes southeast 34806.47\n698   41   male 35.750        1    yes southeast 40273.65\n707   51 female 38.060        0    yes southeast 44400.41\n726   30 female 39.050        3    yes southeast 40932.43\n737   37 female 38.390        0    yes southeast 40419.02\n739   23   male 31.730        3    yes",
        " northeast 36189.10\n740   29   male 35.500        2    yes southwest 44585.46\n743   53   male 34.105        0    yes northeast 43254.42\n760   18   male 38.170        0    yes southeast 36307.80\n804   18 female 42.240        0    yes southeast 38792.69\n820   33 female 35.530        0    yes northwest 55135.40\n827   56   male 31.790        2    yes southeast 43813.87\n829   41   male 30.780        3    yes northeast 39597.41\n843   23 female 32.780        2    yes southeast 36021.01\n846   60 female 32.450        0",
        "    yes southeast 45008.96\n851   37 female 30.780        0    yes northeast 37270.15\n853   46 female 35.530        0    yes northeast 42111.66\n857   48 female 33.110        0    yes southeast 40974.16\n861   37 female 47.600        2    yes southwest 46113.51\n884   51 female 37.050        3    yes northeast 46255.11\n894   47   male 38.940        2    yes southeast 44202.65\n902   60   male 40.920        0    yes southeast 48673.56\n918   45   male 22.895        0    yes northeast 35069.37\n948   37   male 34.200",
        "        1    yes northeast 39047.29\n952   51   male 42.900        2    yes southeast 47462.89\n954   44   male 30.200        2    yes southwest 38998.55\n957   54   male 30.800        1    yes southeast 41999.52\n959   43   male 34.960        1    yes northeast 41034.22\n1013  61 female 33.330        4     no southeast 36580.28\n1022  22 female 31.020        3    yes southeast 35595.59\n1023  47   male 36.080        1    yes southeast 42211.14\n1032  55 female 35.200        0    yes southeast 44423.80\n1037  22   male",
        " 37.070        2    yes southeast 37484.45\n1038  45 female 30.495        1    yes northwest 39725.52\n1048  22   male 52.580        1    yes southeast 44501.40\n1050  49   male 30.900        0    yes southwest 39727.61\n1063  59   male 41.140        1    yes southeast 48970.25\n1071  37   male 37.070        1    yes southeast 39871.70\n1079  28   male 31.680        0    yes southeast 34672.15\n1091  47   male 36.190        0    yes southeast 41676.08\n1097  51 female 34.960        2    yes northeast 44641.20\n1112  38",
        "   male 38.390        3    yes southeast 41949.24\n1118  25   male 33.330        2    yes southeast 36124.57\n1119  33   male 35.750        1    yes southeast 38282.75\n1123  53 female 36.860        3    yes northwest 46661.44\n1125  23 female 42.750        1    yes northeast 40904.20\n1140  19 female 32.490        0    yes northwest 36898.73\n1147  60   male 32.800        0    yes southwest 52590.83\n1153  43 female 32.560        3    yes southeast 40941.29\n1157  19   male 44.880        0    yes southeast 39722.75",
        "\n1187  20   male 35.625        3    yes northwest 37465.34\n1207  59 female 34.800        2     no southwest 36910.61\n1208  36   male 33.400        2    yes southwest 38415.47\n1219  46 female 34.600        1    yes southwest 41661.60\n1231  52   male 34.485        3    yes northwest 60021.40\n1241  52   male 41.800        2    yes southeast 47269.85\n1242  64   male 36.960        2    yes southeast 49577.66\n1250  32   male 33.630        1    yes northeast 37607.53\n1285  61   male 36.300        1    yes southwest",
        " 47403.88\n1289  20   male 39.400        2    yes southwest 38344.57\n1292  19   male 34.900        0    yes southwest 34828.65\n1301  45   male 30.360        0    yes southeast 62592.87\n1302  62   male 30.875        3    yes northwest 46718.16\n1304  43   male 27.800        0    yes southwest 37829.72\n1314  19 female 34.700        2    yes southwest 36397.58\n1324  42 female 40.370        2    yes southeast 43896.38\n",
        "> ",
        "insurance_df[-outliers_ind, ]",
        "    age    sex    bmi children smoker    region   charges\n1    19 female 27.900        0    yes southwest 16884.924\n2    18   male 33.770        1     no southeast  1725.552\n3    28   male 33.000        3     no southeast  4449.462\n4    33   male 22.705        0     no northwest 21984.471\n5    32   male 28.880        0     no northwest  3866.855\n6    31 female 25.740        0     no southeast  3756.622\n7    46 female 33.440        1     no southeast  8240.590\n8    37 female 27.740        3     no northwest  7281.506",
        "\n9    37   male 29.830        2     no northeast  6406.411\n10   60 female 25.840        0     no northwest 28923.137\n11   25   male 26.220        0     no northeast  2721.321\n12   62 female 26.290        0    yes southeast 27808.725\n13   23   male 34.400        0     no southwest  1826.843\n14   56 female 39.820        0     no southeast 11090.718\n16   19   male 24.600        1     no southwest  1837.237\n17   52 female 30.780        1     no northeast 10797.336\n18   23   male 23.845        0     no northeast",
        "  2395.172\n19   56   male 40.300        0     no southwest 10602.385\n21   60 female 36.005        0     no northeast 13228.847\n22   30 female 32.400        1     no southwest  4149.736\n23   18   male 34.100        0     no southeast  1137.011\n25   37   male 28.025        2     no northwest  6203.902\n26   59 female 27.720        3     no southeast 14001.134\n27   63 female 23.085        0     no northeast 14451.835\n28   55 female 32.775        2     no northwest 12268.632\n29   23   male 17.385        1     no",
        " northwest  2775.192\n32   18 female 26.315        0     no northeast  2198.190\n33   19 female 28.600        5     no southwest  4687.797\n34   63   male 28.310        0     no northwest 13770.098\n36   19   male 20.425        0     no northwest  1625.434\n37   62 female 32.965        3     no northwest 15612.193\n38   26   male 20.800        0     no southwest  2302.300\n41   24 female 26.600        0     no northeast  3046.062\n42   31 female 36.630        2     no southeast  4949.759\n43   41   male 21.780        1",
        "     no southeast  6272.477\n44   37 female 30.800        2     no southeast  6313.759\n45   38   male 37.050        1     no northeast  6079.672\n46   55   male 37.300        0     no southwest 20630.284\n47   18 female 38.665        2     no northeast  3393.356\n48   28 female 34.770        0     no northwest  3556.922\n49   60 female 24.530        0     no southeast 12629.897\n51   18 female 35.625        0     no northeast  2211.131\n52   21 female 33.630        2     no northwest  3579.829\n53   48   male 28.000",
        "        1    yes southwest 23568.272\n55   40 female 28.690        3     no northwest  8059.679\n57   58 female 31.825        2     no northeast 13607.369\n58   18   male 31.680        2    yes southeast 34303.167\n59   53 female 22.880        1    yes southeast 23244.790\n60   34 female 37.335        2     no northwest  5989.524\n61   43   male 27.360        3     no northeast  8606.217\n62   25   male 33.660        4     no southeast  4504.662\n63   64   male 24.700        1     no northwest 30166.618\n64   28 female",
        " 25.935        1     no northwest  4133.642\n65   20 female 22.420        0    yes northwest 14711.744\n66   19 female 28.900        0     no southwest  1743.214\n67   61 female 39.100        2     no southwest 14235.072\n68   40   male 26.315        1     no northwest  6389.378\n69   40 female 36.190        0     no southeast  5920.104\n70   28   male 23.980        3    yes southeast 17663.144\n71   27 female 24.750        0    yes southeast 16577.780\n72   31   male 28.500        5     no northeast  6799.458\n73   53",
        " female 28.100        3     no southwest 11741.726\n74   58   male 32.010        1     no southeast 11946.626\n75   44   male 27.400        2     no southwest  7726.854\n76   57   male 34.010        0     no northwest 11356.661\n77   29 female 29.590        1     no southeast  3947.413\n78   21   male 35.530        0     no southeast  1532.470\n79   22 female 39.805        0     no northeast  2755.021\n80   41 female 32.965        0     no northwest  6571.024\n81   31   male 26.885        1     no northeast  4441.213",
        "\n82   45 female 38.285        0     no northeast  7935.291\n84   48 female 41.230        4     no northwest 11033.662\n86   45   male 22.895        2    yes northwest 21098.554\n88   56 female 27.200        0     no southwest 11073.176\n89   46 female 27.740        0     no northwest  8026.667\n90   55 female 26.980        0     no northwest 11082.577\n91   21 female 39.490        0     no southeast  2026.974\n92   53 female 24.795        1     no northwest 10942.132\n93   59   male 29.830        3    yes northeast",
        " 30184.937\n94   35   male 34.770        2     no northwest  5729.005\n96   28 female 37.620        1     no southeast  3766.884\n97   54 female 30.800        3     no southwest 12105.320\n98   55   male 38.280        0     no southeast 10226.284\n99   56   male 19.950        0    yes northeast 22412.648\n100  38   male 19.300        0    yes southwest 15820.699\n101  41 female 31.600        0     no southwest  6186.127\n102  30   male 25.460        0     no northeast  3645.089\n103  18 female 30.115        0     no",
        " northeast 21344.847\n104  61 female 29.920        3    yes southeast 30942.192\n105  34 female 27.500        1     no southwest  5003.853\n106  20   male 28.025        1    yes northwest 17560.380\n107  19 female 28.400        1     no southwest  2331.519\n108  26   male 30.875        2     no northwest  3877.304\n109  29   male 27.940        0     no southeast  2867.120\n111  54   male 33.630        1     no northwest 10825.254\n112  55 female 29.700        2     no southwest 11881.358\n113  37   male 30.800        0",
        "     no southwest  4646.759\n114  21 female 35.720        0     no northwest  2404.734\n115  52   male 32.205        3     no northeast 11488.317\n116  60   male 28.595        0     no northeast 30259.996\n117  58   male 49.060        0     no southeast 11381.325\n118  29 female 27.940        1    yes southeast 19107.780\n119  49 female 27.170        0     no southeast  8601.329\n120  37 female 23.370        2     no northwest  6686.431\n121  44   male 37.100        2     no southwest  7740.337\n122  18   male 23.750",
        "        0     no northeast  1705.624\n123  20 female 28.975        0     no northwest  2257.475\n125  47 female 33.915        3     no northwest 10115.009\n126  26 female 28.785        0     no northeast  3385.399\n127  19 female 28.300        0    yes southwest 17081.080\n128  52 female 37.400        0     no southwest  9634.538\n129  32 female 17.765        2    yes northwest 32734.186\n130  38   male 34.700        2     no southwest  6082.405\n131  59 female 26.505        0     no northeast 12815.445\n132  61 female",
        " 22.040        0     no northeast 13616.359\n133  53 female 35.900        2     no southwest 11163.568\n134  19   male 25.555        0     no northwest  1632.564\n135  20 female 28.785        0     no northeast  2457.211\n136  22 female 28.050        0     no southeast  2155.682\n137  19   male 34.100        0     no southwest  1261.442\n138  22   male 25.175        0     no northwest  2045.685\n139  54 female 31.900        3     no southeast 27322.734\n140  22 female 36.000        0     no southwest  2166.732\n141  34",
        "   male 22.420        2     no northeast 27375.905\n142  26   male 32.490        1     no northeast  3490.549\n143  34   male 25.300        2    yes southeast 18972.495\n144  29   male 29.735        2     no northwest 18157.876\n145  30   male 28.690        3    yes northwest 20745.989\n146  29 female 38.830        3     no southeast  5138.257\n148  51 female 37.730        1     no southeast  9877.608\n149  53 female 37.430        1     no northwest 10959.695\n150  19   male 28.400        1     no southwest  1842.519",
        "\n151  35   male 24.130        1     no northwest  5125.216\n152  48   male 29.700        0     no southeast  7789.635\n153  32 female 37.145        3     no northeast  6334.344\n154  42 female 23.370        0    yes northeast 19964.746\n155  40 female 25.460        1     no northeast  7077.189\n156  44   male 39.520        0     no northwest  6948.701\n157  48   male 24.420        0    yes southeast 21223.676\n158  18   male 25.175        0    yes northeast 15518.180\n160  50 female 27.830        3     no southeast",
        " 19749.383\n161  42 female 26.600        0    yes northwest 21348.706\n [ reached 'max' / getOption(\"max.print\") -- omitted 1057 rows ]\n",
        "> ",
        "insurance_df_no <- insurance_df[-outliers_ind,]",
        "> ",
        "library(caret)",
        "Loading required package: lattice\n",
        "\nAttaching package: ‘caret’\n\n",
        "The following object is masked from ‘package:purrr’:\n\n    lift\n\n",
        "> ",
        "dmy = dummyVars(\" ~ .\", data = insurance_df_no[, -7])",
        "> ",
        "encode_df = data.frame(predict(dmy, newdata = insurance_df_no[, -7]))",
        "> ",
        "encode_df$charges <- insurance_df_no$charges",
        "> ",
        "m <- nrow(insurance_df_no)",
        "> ",
        "set.seed(2021)",
        "> ",
        "train_idx <- sample(m, m * 0.8)",
        "> ",
        "",
        "> ",
        "train_df <- insurance_df_no[train_idx, ]",
        "> ",
        "test_df <- insurance_df_no[-train_idx, ]",
        "> ",
        "fit.linreg <- lm(charges ~ smoker+age+bmi+children+region, data = train_df)",
        "> ",
        "summary(fit.linreg)",
        "\nCall:\nlm(formula = charges ~ smoker + age + bmi + children + region, \n    data = train_df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6196.0 -1856.5 -1193.6  -390.9 21922.8 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     -3455.56     912.73  -3.786 0.000163 ***\nsmokeryes       14917.04     481.14  31.004  < 2e-16 ***\nage               241.26      10.66  22.640  < 2e-16 ***\nbmi                85.12      27.07   3.145 0.001714 ** \nchildren1        -197.42     375.22",
        "  -0.526 0.598908    \nchildren2        1453.84     418.99   3.470 0.000544 ***\nchildren3         827.46     504.07   1.642 0.101014    \nchildren4        3134.25    1074.52   2.917 0.003619 ** \nchildren5        1398.47    1170.68   1.195 0.232550    \nregionnorthwest  -378.43     415.57  -0.911 0.362726    \nregionsoutheast -1151.30     431.65  -2.667 0.007780 ** \nregionsouthwest -1360.83     425.41  -3.199 0.001426 ** \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error:",
        " 4573 on 947 degrees of freedom\nMultiple R-squared:  0.6075,\tAdjusted R-squared:  0.603 \nF-statistic: 133.3 on 11 and 947 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "fit.polyreg <- lm(charges ~ smoker+age+bmi+children+region+",
        "+ ",
        "                    I(age^2)+I(bmi^2)+I(smoker^2)+I(smoker^3), data = train_df)",
        "Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) : \n  contrasts can be applied only to factors with 2 or more levels\n",
        "In addition: ",
        "Warning messages:\n",
        "1: ",
        "In Ops.factor(smoker, 2) :",
        " ‘^’ not meaningful for factors\n",
        "2: ",
        "In Ops.factor(smoker, 3) :",
        " ‘^’ not meaningful for factors\n",
        "> ",
        "summary(fit.polyreg)",
        "Error in h(simpleError(msg, call)) : \n  error in evaluating the argument 'object' in selecting a method for function 'summary': object 'fit.polyreg' not found\n",
        "> ",
        "fit.multireg <- lm(formula = charges ~ ., data = train_df)",
        "> ",
        "summary(fit.multireg)",
        "\nCall:\nlm(formula = charges ~ ., data = train_df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6435.1 -1879.0 -1157.8  -403.1 21692.0 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     -3239.26     922.52  -3.511 0.000467 ***\nage               241.23      10.65  22.655  < 2e-16 ***\nsexmale          -461.20     295.60  -1.560 0.119041    \nbmi                85.35      27.05   3.156 0.001652 ** \nchildren1        -204.00     374.96  -0.544 0.586527    \nchildren2      ",
        "  1455.00     418.68   3.475 0.000534 ***\nchildren3         823.64     503.70   1.635 0.102344    \nchildren4        3199.53    1074.52   2.978 0.002979 ** \nchildren5        1432.13    1169.99   1.224 0.221236    \nsmokeryes       14935.48     480.92  31.056  < 2e-16 ***\nregionnorthwest  -374.42     415.26  -0.902 0.367471    \nregionsoutheast -1141.45     431.37  -2.646 0.008278 ** \nregionsouthwest -1362.40     425.09  -3.205 0.001396 ** \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1",
        "\n\nResidual standard error: 4569 on 946 degrees of freedom\nMultiple R-squared:  0.6085,\tAdjusted R-squared:  0.6036 \nF-statistic: 122.5 on 12 and 946 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "fit.inmultireg <- lm(charges ~ smoker+age+bmi+children+region+I(age^2)+I(bmi^2)+age:bmi, data = train_df)",
        "> ",
        "summary(fit.inmultireg)",
        "\nCall:\nlm(formula = charges ~ smoker + age + bmi + children + region + \n    I(age^2) + I(bmi^2) + age:bmi, data = train_df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5875.7 -1851.0 -1163.4  -456.1 22372.6 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     -7571.3264  3484.3863  -2.173 0.030034 *  \nsmokeryes       14971.4835   473.7368  31.603  < 2e-16 ***\nage              -107.4752    88.5474  -1.214 0.225143    \nbmi               736.2448   195.5878   3.764",
        " 0.000177 ***\nchildren1         462.3005   391.7738   1.180 0.238290    \nchildren2        2225.2105   437.8171   5.083 4.49e-07 ***\nchildren3        1427.4495   512.2862   2.786 0.005436 ** \nchildren4        3568.1893  1064.8946   3.351 0.000838 ***\nchildren5        2317.1041  1162.3354   1.993 0.046495 *  \nregionnorthwest  -405.6619   410.3696  -0.989 0.323147    \nregionsoutheast -1103.1741   425.2628  -2.594 0.009631 ** \nregionsouthwest -1342.1783   419.3609  -3.201 0.001418 ** \nI(age^2)            4.6458",
        "     0.9501   4.890 1.19e-06 ***\nI(bmi^2)          -10.1378     3.1670  -3.201 0.001415 ** \nage:bmi            -0.6101     1.8226  -0.335 0.737880    \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 4497 on 944 degrees of freedom\nMultiple R-squared:  0.6216,\tAdjusted R-squared:  0.616 \nF-statistic: 110.8 on 14 and 944 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "performance = function(test_df, model, model_name) {",
        "+ ",
        "  ",
        "+ ",
        "  pred <- predict(model, test_df)",
        "+ ",
        "  error <- pred - test_df$charges",
        "+ ",
        "  mse <- mean(error ^ 2)",
        "+ ",
        "  rmse <- sqrt(mse)",
        "+ ",
        "  ",
        "+ ",
        "  result <- paste(\"RMSE of\", model_name, \":\",",
        "+ ",
        "                  round(rmse, 2))",
        "+ ",
        "  result",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "performance(test_df, fit.linreg, \"Simple Linear Regression\")",
        "[1] \"RMSE of Simple Linear Regression : 4597.67\"\n",
        "> ",
        "performance(test_df, fit.polyreg, \"Polynomial Regression\")",
        "Error in predict(model, test_df) : object 'fit.polyreg' not found\n",
        "> ",
        "performance(test_df, fit.multireg, \"Multiple Linear Regression\")",
        "[1] \"RMSE of Multiple Linear Regression : 4604.69\"\n",
        "> ",
        "performance(test_df, fit.inmultireg, \"MLR with Interaction\")",
        "[1] \"RMSE of MLR with Interaction : 4478.03\"\n",
        "> ",
        "fit.polyreg <- lm(charges ~ smoker+age+bmi+children+region+I(age^2)+I(bmi^2)+I(smoker^2)+I(smoker^3), data = train_df)",
        "Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) : \n  contrasts can be applied only to factors with 2 or more levels\n",
        "In addition: ",
        "Warning messages:\n",
        "1: ",
        "In Ops.factor(smoker, 2) :",
        " ‘^’ not meaningful for factors\n",
        "2: ",
        "In Ops.factor(smoker, 3) :",
        " ‘^’ not meaningful for factors\n",
        "> ",
        "summary(fit.polyreg)",
        "Error in h(simpleError(msg, call)) : \n  error in evaluating the argument 'object' in selecting a method for function 'summary': object 'fit.polyreg' not found\n",
        "> ",
        "fit.polyreg <- lm(charges ~ smoker+age+bmi+children+region+I(age^2)+I(bmi^2)+I(smoker^2)+I(smoker^3), data = train_df)",
        "Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) : \n  contrasts can be applied only to factors with 2 or more levels\n",
        "In addition: ",
        "Warning messages:\n",
        "1: ",
        "In Ops.factor(smoker, 2) :",
        " ‘^’ not meaningful for factors\n",
        "2: ",
        "In Ops.factor(smoker, 3) :",
        " ‘^’ not meaningful for factors\n",
        "> ",
        "summary(fit.polyreg)",
        "Error in h(simpleError(msg, call)) : \n  error in evaluating the argument 'object' in selecting a method for function 'summary': object 'fit.polyreg' not found\n",
        "> ",
        "fit.polyreg <- lm(charges ~ smoker+age+bmi+children+region+I(age^2)+I(bmi^2)+I(smoker^2), data = train_df)",
        "Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) : \n  contrasts can be applied only to factors with 2 or more levels\n",
        "In addition: ",
        "Warning message:\n",
        "In Ops.factor(smoker, 2) :",
        " ‘^’ not meaningful for factors\n",
        "> ",
        "summary(fit.polyreg)",
        "Error in h(simpleError(msg, call)) : \n  error in evaluating the argument 'object' in selecting a method for function 'summary': object 'fit.polyreg' not found\n",
        "> ",
        "# Prediction of Health Insurance Costs",
        "> ",
        "",
        "> ",
        "# Installing Packages",
        "> ",
        "install.packages(\"tidyverse\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"psych\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"ggridges\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"broom.mixed\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"viridis\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"modelr\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"lme4\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"patchwork\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "",
        "> ",
        "# Load the libraries",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(psych)",
        "> ",
        "library(ggridges)",
        "> ",
        "library(broom.mixed)",
        "> ",
        "library(viridis)",
        "> ",
        "library(modelr)",
        "> ",
        "library(lme4)",
        "> ",
        "library(patchwork)",
        "> ",
        "",
        "> ",
        "# 1. Data Extraction",
        "> ",
        "insurance_df <- read.csv(\"data/insurance.csv\")",
        "> ",
        "insurance_df",
        "    age    sex    bmi children smoker    region   charges\n1    19 female 27.900        0    yes southwest 16884.924\n2    18   male 33.770        1     no southeast  1725.552\n3    28   male 33.000        3     no southeast  4449.462\n4    33   male 22.705        0     no northwest 21984.471\n5    32   male 28.880        0     no northwest  3866.855\n6    31 female 25.740        0     no southeast  3756.622\n7    46 female 33.440        1     no southeast  8240.590\n8    37 female 27.740        3     no northwest  7281.506",
        "\n9    37   male 29.830        2     no northeast  6406.411\n10   60 female 25.840        0     no northwest 28923.137\n11   25   male 26.220        0     no northeast  2721.321\n12   62 female 26.290        0    yes southeast 27808.725\n13   23   male 34.400        0     no southwest  1826.843\n14   56 female 39.820        0     no southeast 11090.718\n15   27   male 42.130        0    yes southeast 39611.758\n16   19   male 24.600        1     no southwest  1837.237\n17   52 female 30.780        1     no northeast",
        " 10797.336\n18   23   male 23.845        0     no northeast  2395.172\n19   56   male 40.300        0     no southwest 10602.385\n20   30   male 35.300        0    yes southwest 36837.467\n21   60 female 36.005        0     no northeast 13228.847\n22   30 female 32.400        1     no southwest  4149.736\n23   18   male 34.100        0     no southeast  1137.011\n24   34 female 31.920        1    yes northeast 37701.877\n25   37   male 28.025        2     no northwest  6203.902\n26   59 female 27.720        3     no",
        " southeast 14001.134\n27   63 female 23.085        0     no northeast 14451.835\n28   55 female 32.775        2     no northwest 12268.632\n29   23   male 17.385        1     no northwest  2775.192\n30   31   male 36.300        2    yes southwest 38711.000\n31   22   male 35.600        0    yes southwest 35585.576\n32   18 female 26.315        0     no northeast  2198.190\n33   19 female 28.600        5     no southwest  4687.797\n34   63   male 28.310        0     no northwest 13770.098\n35   28   male 36.400        1",
        "    yes southwest 51194.559\n36   19   male 20.425        0     no northwest  1625.434\n37   62 female 32.965        3     no northwest 15612.193\n38   26   male 20.800        0     no southwest  2302.300\n39   35   male 36.670        1    yes northeast 39774.276\n40   60   male 39.900        0    yes southwest 48173.361\n41   24 female 26.600        0     no northeast  3046.062\n42   31 female 36.630        2     no southeast  4949.759\n43   41   male 21.780        1     no southeast  6272.477\n44   37 female 30.800",
        "        2     no southeast  6313.759\n45   38   male 37.050        1     no northeast  6079.672\n46   55   male 37.300        0     no southwest 20630.284\n47   18 female 38.665        2     no northeast  3393.356\n48   28 female 34.770        0     no northwest  3556.922\n49   60 female 24.530        0     no southeast 12629.897\n50   36   male 35.200        1    yes southeast 38709.176\n51   18 female 35.625        0     no northeast  2211.131\n52   21 female 33.630        2     no northwest  3579.829\n53   48   male",
        " 28.000        1    yes southwest 23568.272\n54   36   male 34.430        0    yes southeast 37742.576\n55   40 female 28.690        3     no northwest  8059.679\n56   58   male 36.955        2    yes northwest 47496.494\n57   58 female 31.825        2     no northeast 13607.369\n58   18   male 31.680        2    yes southeast 34303.167\n59   53 female 22.880        1    yes southeast 23244.790\n60   34 female 37.335        2     no northwest  5989.524\n61   43   male 27.360        3     no northeast  8606.217\n62   25",
        "   male 33.660        4     no southeast  4504.662\n63   64   male 24.700        1     no northwest 30166.618\n64   28 female 25.935        1     no northwest  4133.642\n65   20 female 22.420        0    yes northwest 14711.744\n66   19 female 28.900        0     no southwest  1743.214\n67   61 female 39.100        2     no southwest 14235.072\n68   40   male 26.315        1     no northwest  6389.378\n69   40 female 36.190        0     no southeast  5920.104\n70   28   male 23.980        3    yes southeast 17663.144",
        "\n71   27 female 24.750        0    yes southeast 16577.780\n72   31   male 28.500        5     no northeast  6799.458\n73   53 female 28.100        3     no southwest 11741.726\n74   58   male 32.010        1     no southeast 11946.626\n75   44   male 27.400        2     no southwest  7726.854\n76   57   male 34.010        0     no northwest 11356.661\n77   29 female 29.590        1     no southeast  3947.413\n78   21   male 35.530        0     no southeast  1532.470\n79   22 female 39.805        0     no northeast",
        "  2755.021\n80   41 female 32.965        0     no northwest  6571.024\n81   31   male 26.885        1     no northeast  4441.213\n82   45 female 38.285        0     no northeast  7935.291\n83   22   male 37.620        1    yes southeast 37165.164\n84   48 female 41.230        4     no northwest 11033.662\n85   37 female 34.800        2    yes southwest 39836.519\n86   45   male 22.895        2    yes northwest 21098.554\n87   57 female 31.160        0    yes northwest 43578.939\n88   56 female 27.200        0     no",
        " southwest 11073.176\n89   46 female 27.740        0     no northwest  8026.667\n90   55 female 26.980        0     no northwest 11082.577\n91   21 female 39.490        0     no southeast  2026.974\n92   53 female 24.795        1     no northwest 10942.132\n93   59   male 29.830        3    yes northeast 30184.937\n94   35   male 34.770        2     no northwest  5729.005\n95   64 female 31.300        2    yes southwest 47291.055\n96   28 female 37.620        1     no southeast  3766.884\n97   54 female 30.800        3",
        "     no southwest 12105.320\n98   55   male 38.280        0     no southeast 10226.284\n99   56   male 19.950        0    yes northeast 22412.648\n100  38   male 19.300        0    yes southwest 15820.699\n101  41 female 31.600        0     no southwest  6186.127\n102  30   male 25.460        0     no northeast  3645.089\n103  18 female 30.115        0     no northeast 21344.847\n104  61 female 29.920        3    yes southeast 30942.192\n105  34 female 27.500        1     no southwest  5003.853\n106  20   male 28.025",
        "        1    yes northwest 17560.380\n107  19 female 28.400        1     no southwest  2331.519\n108  26   male 30.875        2     no northwest  3877.304\n109  29   male 27.940        0     no southeast  2867.120\n110  63   male 35.090        0    yes southeast 47055.532\n111  54   male 33.630        1     no northwest 10825.254\n112  55 female 29.700        2     no southwest 11881.358\n113  37   male 30.800        0     no southwest  4646.759\n114  21 female 35.720        0     no northwest  2404.734\n115  52   male",
        " 32.205        3     no northeast 11488.317\n116  60   male 28.595        0     no northeast 30259.996\n117  58   male 49.060        0     no southeast 11381.325\n118  29 female 27.940        1    yes southeast 19107.780\n119  49 female 27.170        0     no southeast  8601.329\n120  37 female 23.370        2     no northwest  6686.431\n121  44   male 37.100        2     no southwest  7740.337\n122  18   male 23.750        0     no northeast  1705.624\n123  20 female 28.975        0     no northwest  2257.475\n124  44",
        "   male 31.350        1    yes northeast 39556.495\n125  47 female 33.915        3     no northwest 10115.009\n126  26 female 28.785        0     no northeast  3385.399\n127  19 female 28.300        0    yes southwest 17081.080\n128  52 female 37.400        0     no southwest  9634.538\n129  32 female 17.765        2    yes northwest 32734.186\n130  38   male 34.700        2     no southwest  6082.405\n131  59 female 26.505        0     no northeast 12815.445\n132  61 female 22.040        0     no northeast 13616.359",
        "\n133  53 female 35.900        2     no southwest 11163.568\n134  19   male 25.555        0     no northwest  1632.564\n135  20 female 28.785        0     no northeast  2457.211\n136  22 female 28.050        0     no southeast  2155.682\n137  19   male 34.100        0     no southwest  1261.442\n138  22   male 25.175        0     no northwest  2045.685\n139  54 female 31.900        3     no southeast 27322.734\n140  22 female 36.000        0     no southwest  2166.732\n141  34   male 22.420        2     no northeast",
        " 27375.905\n142  26   male 32.490        1     no northeast  3490.549\n [ reached 'max' / getOption(\"max.print\") -- omitted 1196 rows ]\n",
        "> ",
        "",
        "> ",
        "## 1.1. Check for Missing Values",
        "> ",
        "insurance_df %>%",
        "+ ",
        "  summarise_all(",
        "+ ",
        "    ~ sum(is.na(.))",
        "+ ",
        "  )",
        "  age sex bmi children smoker region charges\n1   0   0   0        0      0      0       0\n",
        "> ",
        "summary(insurance_df)",
        "      age            sex                 bmi           children    \n Min.   :18.00   Length:1338        Min.   :15.96   Min.   :0.000  \n 1st Qu.:27.00   Class :character   1st Qu.:26.30   1st Qu.:0.000  \n Median :39.00   Mode  :character   Median :30.40   Median :1.000  \n Mean   :39.21                      Mean   :30.66   Mean   :1.095  \n 3rd Qu.:51.00                      3rd Qu.:34.69   3rd Qu.:2.000  \n Max.   :64.00                      Max.   :53.13   Max.   :5.000  \n    smoker             region         ",
        "    charges     \n Length:1338        Length:1338        Min.   : 1122  \n Class :character   Class :character   1st Qu.: 4740  \n Mode  :character   Mode  :character   Median : 9382  \n                                       Mean   :13270  \n                                       3rd Qu.:16640  \n                                       Max.   :63770  \n",
        "> ",
        "",
        "> ",
        "## 1.2. Change Target to Factor",
        "> ",
        "insurance_df <- insurance_df %>%",
        "+ ",
        "  mutate(sex = factor(sex),",
        "+ ",
        "         smoker = factor(smoker),",
        "+ ",
        "         region = factor(region),",
        "+ ",
        "         children = factor(children)",
        "+ ",
        "  ) ",
        "> ",
        "insurance_df",
        "    age    sex    bmi children smoker    region   charges\n1    19 female 27.900        0    yes southwest 16884.924\n2    18   male 33.770        1     no southeast  1725.552\n3    28   male 33.000        3     no southeast  4449.462\n4    33   male 22.705        0     no northwest 21984.471\n5    32   male 28.880        0     no northwest  3866.855\n6    31 female 25.740        0     no southeast  3756.622\n7    46 female 33.440        1     no southeast  8240.590\n8    37 female 27.740        3     no northwest  7281.506",
        "\n9    37   male 29.830        2     no northeast  6406.411\n10   60 female 25.840        0     no northwest 28923.137\n11   25   male 26.220        0     no northeast  2721.321\n12   62 female 26.290        0    yes southeast 27808.725\n13   23   male 34.400        0     no southwest  1826.843\n14   56 female 39.820        0     no southeast 11090.718\n15   27   male 42.130        0    yes southeast 39611.758\n16   19   male 24.600        1     no southwest  1837.237\n17   52 female 30.780        1     no northeast",
        " 10797.336\n18   23   male 23.845        0     no northeast  2395.172\n19   56   male 40.300        0     no southwest 10602.385\n20   30   male 35.300        0    yes southwest 36837.467\n21   60 female 36.005        0     no northeast 13228.847\n22   30 female 32.400        1     no southwest  4149.736\n23   18   male 34.100        0     no southeast  1137.011\n24   34 female 31.920        1    yes northeast 37701.877\n25   37   male 28.025        2     no northwest  6203.902\n26   59 female 27.720        3     no",
        " southeast 14001.134\n27   63 female 23.085        0     no northeast 14451.835\n28   55 female 32.775        2     no northwest 12268.632\n29   23   male 17.385        1     no northwest  2775.192\n30   31   male 36.300        2    yes southwest 38711.000\n31   22   male 35.600        0    yes southwest 35585.576\n32   18 female 26.315        0     no northeast  2198.190\n33   19 female 28.600        5     no southwest  4687.797\n34   63   male 28.310        0     no northwest 13770.098\n35   28   male 36.400        1",
        "    yes southwest 51194.559\n36   19   male 20.425        0     no northwest  1625.434\n37   62 female 32.965        3     no northwest 15612.193\n38   26   male 20.800        0     no southwest  2302.300\n39   35   male 36.670        1    yes northeast 39774.276\n40   60   male 39.900        0    yes southwest 48173.361\n41   24 female 26.600        0     no northeast  3046.062\n42   31 female 36.630        2     no southeast  4949.759\n43   41   male 21.780        1     no southeast  6272.477\n44   37 female 30.800",
        "        2     no southeast  6313.759\n45   38   male 37.050        1     no northeast  6079.672\n46   55   male 37.300        0     no southwest 20630.284\n47   18 female 38.665        2     no northeast  3393.356\n48   28 female 34.770        0     no northwest  3556.922\n49   60 female 24.530        0     no southeast 12629.897\n50   36   male 35.200        1    yes southeast 38709.176\n51   18 female 35.625        0     no northeast  2211.131\n52   21 female 33.630        2     no northwest  3579.829\n53   48   male",
        " 28.000        1    yes southwest 23568.272\n54   36   male 34.430        0    yes southeast 37742.576\n55   40 female 28.690        3     no northwest  8059.679\n56   58   male 36.955        2    yes northwest 47496.494\n57   58 female 31.825        2     no northeast 13607.369\n58   18   male 31.680        2    yes southeast 34303.167\n59   53 female 22.880        1    yes southeast 23244.790\n60   34 female 37.335        2     no northwest  5989.524\n61   43   male 27.360        3     no northeast  8606.217\n62   25",
        "   male 33.660        4     no southeast  4504.662\n63   64   male 24.700        1     no northwest 30166.618\n64   28 female 25.935        1     no northwest  4133.642\n65   20 female 22.420        0    yes northwest 14711.744\n66   19 female 28.900        0     no southwest  1743.214\n67   61 female 39.100        2     no southwest 14235.072\n68   40   male 26.315        1     no northwest  6389.378\n69   40 female 36.190        0     no southeast  5920.104\n70   28   male 23.980        3    yes southeast 17663.144",
        "\n71   27 female 24.750        0    yes southeast 16577.780\n72   31   male 28.500        5     no northeast  6799.458\n73   53 female 28.100        3     no southwest 11741.726\n74   58   male 32.010        1     no southeast 11946.626\n75   44   male 27.400        2     no southwest  7726.854\n76   57   male 34.010        0     no northwest 11356.661\n77   29 female 29.590        1     no southeast  3947.413\n78   21   male 35.530        0     no southeast  1532.470\n79   22 female 39.805        0     no northeast",
        "  2755.021\n80   41 female 32.965        0     no northwest  6571.024\n81   31   male 26.885        1     no northeast  4441.213\n82   45 female 38.285        0     no northeast  7935.291\n83   22   male 37.620        1    yes southeast 37165.164\n84   48 female 41.230        4     no northwest 11033.662\n85   37 female 34.800        2    yes southwest 39836.519\n86   45   male 22.895        2    yes northwest 21098.554\n87   57 female 31.160        0    yes northwest 43578.939\n88   56 female 27.200        0     no",
        " southwest 11073.176\n89   46 female 27.740        0     no northwest  8026.667\n90   55 female 26.980        0     no northwest 11082.577\n91   21 female 39.490        0     no southeast  2026.974\n92   53 female 24.795        1     no northwest 10942.132\n93   59   male 29.830        3    yes northeast 30184.937\n94   35   male 34.770        2     no northwest  5729.005\n95   64 female 31.300        2    yes southwest 47291.055\n96   28 female 37.620        1     no southeast  3766.884\n97   54 female 30.800        3",
        "     no southwest 12105.320\n98   55   male 38.280        0     no southeast 10226.284\n99   56   male 19.950        0    yes northeast 22412.648\n100  38   male 19.300        0    yes southwest 15820.699\n101  41 female 31.600        0     no southwest  6186.127\n102  30   male 25.460        0     no northeast  3645.089\n103  18 female 30.115        0     no northeast 21344.847\n104  61 female 29.920        3    yes southeast 30942.192\n105  34 female 27.500        1     no southwest  5003.853\n106  20   male 28.025",
        "        1    yes northwest 17560.380\n107  19 female 28.400        1     no southwest  2331.519\n108  26   male 30.875        2     no northwest  3877.304\n109  29   male 27.940        0     no southeast  2867.120\n110  63   male 35.090        0    yes southeast 47055.532\n111  54   male 33.630        1     no northwest 10825.254\n112  55 female 29.700        2     no southwest 11881.358\n113  37   male 30.800        0     no southwest  4646.759\n114  21 female 35.720        0     no northwest  2404.734\n115  52   male",
        " 32.205        3     no northeast 11488.317\n116  60   male 28.595        0     no northeast 30259.996\n117  58   male 49.060        0     no southeast 11381.325\n118  29 female 27.940        1    yes southeast 19107.780\n119  49 female 27.170        0     no southeast  8601.329\n120  37 female 23.370        2     no northwest  6686.431\n121  44   male 37.100        2     no southwest  7740.337\n122  18   male 23.750        0     no northeast  1705.624\n123  20 female 28.975        0     no northwest  2257.475\n124  44",
        "   male 31.350        1    yes northeast 39556.495\n125  47 female 33.915        3     no northwest 10115.009\n126  26 female 28.785        0     no northeast  3385.399\n127  19 female 28.300        0    yes southwest 17081.080\n128  52 female 37.400        0     no southwest  9634.538\n129  32 female 17.765        2    yes northwest 32734.186\n130  38   male 34.700        2     no southwest  6082.405\n131  59 female 26.505        0     no northeast 12815.445\n132  61 female 22.040        0     no northeast 13616.359",
        "\n133  53 female 35.900        2     no southwest 11163.568\n134  19   male 25.555        0     no northwest  1632.564\n135  20 female 28.785        0     no northeast  2457.211\n136  22 female 28.050        0     no southeast  2155.682\n137  19   male 34.100        0     no southwest  1261.442\n138  22   male 25.175        0     no northwest  2045.685\n139  54 female 31.900        3     no southeast 27322.734\n140  22 female 36.000        0     no southwest  2166.732\n141  34   male 22.420        2     no northeast",
        " 27375.905\n142  26   male 32.490        1     no northeast  3490.549\n [ reached 'max' / getOption(\"max.print\") -- omitted 1196 rows ]\n",
        "> ",
        "",
        "> ",
        "# 2. Exploratory Data Analysis (EDA)",
        "> ",
        "## 2.1 Insurance Variables",
        "> ",
        "insurance_df %>% ",
        "+ ",
        "  ggplot(aes(charges, ..density.., fill = I(\"#d45087\"))) +",
        "+ ",
        "  geom_histogram(bins = 50) +",
        "+ ",
        "  geom_density()+",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "tibble(low_charges = nrow(filter(insurance_df,charges<15000 )),",
        "+ ",
        "       middle_charges =  nrow(filter(insurance_df,charges>=15000 & charges<50000)),",
        "+ ",
        "       high_charges = nrow(filter(insurance_df, charges>=50000)),",
        "+ ",
        ")",
        "\u001B[90m# A tibble: 1 x 3\u001B[39m\n  low_charges middle_charges high_charges\n        \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m          \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m        \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m\n\u001B[90m1\u001B[39m         980            351            7\n",
        "> ",
        "",
        "> ",
        "## 2.2 Age Variables",
        "> ",
        "insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, fill = I(\"#d45087\")))+",
        "+ ",
        "  geom_bar()+ ",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, charges))+",
        "+ ",
        "  geom_point(color = I(\"#d45087\"))",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, charges, color = smoker))+",
        "+ ",
        "  geom_point()",
        "> ",
        "",
        "> ",
        "p1+p2",
        "> ",
        "",
        "> ",
        "## 2.3. Sex Variables",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  count(sex) %>% ",
        "+ ",
        "  ggplot(aes(sex, n, fill = I(\"#d45087\")))+",
        "+ ",
        "  geom_col()+",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(charges, sex, fill = sex)) +",
        "+ ",
        "  ggridges::geom_density_ridges()",
        "> ",
        "",
        "> ",
        "p3 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(sex, charges, fill = sex))+",
        "+ ",
        "  geom_boxplot()",
        "> ",
        "",
        "> ",
        "(p1+p2)/p3",
        "Picking joint bandwidth of 2190\n",
        "> ",
        "",
        "> ",
        "## 2.4. BMI Variables",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(x = bmi, y = stat(density))) +",
        "+ ",
        "  geom_histogram( aes(fill = I(\"#d45087\")), bins = 50) +",
        "+ ",
        "  theme(legend.position = \"none\") +",
        "+ ",
        "  geom_density()",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(x = bmi, charges, color = charges)) +",
        "+ ",
        "  geom_point() +",
        "+ ",
        "  scale_color_viridis(option = \"E\")",
        "> ",
        "",
        "> ",
        "p3 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(factor(age), bmi, color = I(\"#d45087\"))) +",
        "+ ",
        "  geom_point() +",
        "+ ",
        "  geom_jitter() +",
        "+ ",
        "  stat_summary(fun = mean, colour = \"blue\", geom = \"point\", size = 5)",
        "> ",
        "",
        "> ",
        "(p1+p2)/p3",
        "\nRestarting R session...\n\n\nRestarting R session...\n\n"
    ]
}