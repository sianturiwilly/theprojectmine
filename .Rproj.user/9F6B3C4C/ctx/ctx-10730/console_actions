{
    "type": [
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2
    ],
    "data": [
        "> ",
        "# Prediction of Health Insurance Costs",
        "> ",
        "",
        "> ",
        "# Installing Packages",
        "> ",
        "install.packages(\"tidyverse\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"psych\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"ggridges\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"broom.mixed\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"viridis\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"modelr\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"lme4\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages(\"patchwork\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "",
        "> ",
        "# Load the libraries",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(psych)",
        "> ",
        "library(ggridges)",
        "> ",
        "library(broom.mixed)",
        "> ",
        "library(viridis)",
        "> ",
        "library(modelr)",
        "> ",
        "library(lme4)",
        "> ",
        "library(patchwork)",
        "> ",
        "",
        "> ",
        "# 1. Data Extraction",
        "> ",
        "insurance_df <- read.csv(\"data/insurance.csv\")",
        "> ",
        "insurance_df",
        "    age    sex    bmi children smoker    region   charges\n1    19 female 27.900        0    yes southwest 16884.924\n2    18   male 33.770        1     no southeast  1725.552\n3    28   male 33.000        3     no southeast  4449.462\n4    33   male 22.705        0     no northwest 21984.471\n5    32   male 28.880        0     no northwest  3866.855\n6    31 female 25.740        0     no southeast  3756.622\n7    46 female 33.440        1     no southeast  8240.590\n8    37 female 27.740        3     no northwest  7281.506",
        "\n9    37   male 29.830        2     no northeast  6406.411\n10   60 female 25.840        0     no northwest 28923.137\n11   25   male 26.220        0     no northeast  2721.321\n12   62 female 26.290        0    yes southeast 27808.725\n13   23   male 34.400        0     no southwest  1826.843\n14   56 female 39.820        0     no southeast 11090.718\n15   27   male 42.130        0    yes southeast 39611.758\n16   19   male 24.600        1     no southwest  1837.237\n17   52 female 30.780        1     no northeast",
        " 10797.336\n18   23   male 23.845        0     no northeast  2395.172\n19   56   male 40.300        0     no southwest 10602.385\n20   30   male 35.300        0    yes southwest 36837.467\n21   60 female 36.005        0     no northeast 13228.847\n22   30 female 32.400        1     no southwest  4149.736\n23   18   male 34.100        0     no southeast  1137.011\n24   34 female 31.920        1    yes northeast 37701.877\n25   37   male 28.025        2     no northwest  6203.902\n26   59 female 27.720        3     no",
        " southeast 14001.134\n27   63 female 23.085        0     no northeast 14451.835\n28   55 female 32.775        2     no northwest 12268.632\n29   23   male 17.385        1     no northwest  2775.192\n30   31   male 36.300        2    yes southwest 38711.000\n31   22   male 35.600        0    yes southwest 35585.576\n32   18 female 26.315        0     no northeast  2198.190\n33   19 female 28.600        5     no southwest  4687.797\n34   63   male 28.310        0     no northwest 13770.098\n35   28   male 36.400        1",
        "    yes southwest 51194.559\n36   19   male 20.425        0     no northwest  1625.434\n37   62 female 32.965        3     no northwest 15612.193\n38   26   male 20.800        0     no southwest  2302.300\n39   35   male 36.670        1    yes northeast 39774.276\n40   60   male 39.900        0    yes southwest 48173.361\n41   24 female 26.600        0     no northeast  3046.062\n42   31 female 36.630        2     no southeast  4949.759\n43   41   male 21.780        1     no southeast  6272.477\n44   37 female 30.800",
        "        2     no southeast  6313.759\n45   38   male 37.050        1     no northeast  6079.672\n46   55   male 37.300        0     no southwest 20630.284\n47   18 female 38.665        2     no northeast  3393.356\n48   28 female 34.770        0     no northwest  3556.922\n49   60 female 24.530        0     no southeast 12629.897\n50   36   male 35.200        1    yes southeast 38709.176\n51   18 female 35.625        0     no northeast  2211.131\n52   21 female 33.630        2     no northwest  3579.829\n53   48   male",
        " 28.000        1    yes southwest 23568.272\n54   36   male 34.430        0    yes southeast 37742.576\n55   40 female 28.690        3     no northwest  8059.679\n56   58   male 36.955        2    yes northwest 47496.494\n57   58 female 31.825        2     no northeast 13607.369\n58   18   male 31.680        2    yes southeast 34303.167\n59   53 female 22.880        1    yes southeast 23244.790\n60   34 female 37.335        2     no northwest  5989.524\n61   43   male 27.360        3     no northeast  8606.217\n62   25",
        "   male 33.660        4     no southeast  4504.662\n63   64   male 24.700        1     no northwest 30166.618\n64   28 female 25.935        1     no northwest  4133.642\n65   20 female 22.420        0    yes northwest 14711.744\n66   19 female 28.900        0     no southwest  1743.214\n67   61 female 39.100        2     no southwest 14235.072\n68   40   male 26.315        1     no northwest  6389.378\n69   40 female 36.190        0     no southeast  5920.104\n70   28   male 23.980        3    yes southeast 17663.144",
        "\n71   27 female 24.750        0    yes southeast 16577.780\n72   31   male 28.500        5     no northeast  6799.458\n73   53 female 28.100        3     no southwest 11741.726\n74   58   male 32.010        1     no southeast 11946.626\n75   44   male 27.400        2     no southwest  7726.854\n76   57   male 34.010        0     no northwest 11356.661\n77   29 female 29.590        1     no southeast  3947.413\n78   21   male 35.530        0     no southeast  1532.470\n79   22 female 39.805        0     no northeast",
        "  2755.021\n80   41 female 32.965        0     no northwest  6571.024\n81   31   male 26.885        1     no northeast  4441.213\n82   45 female 38.285        0     no northeast  7935.291\n83   22   male 37.620        1    yes southeast 37165.164\n84   48 female 41.230        4     no northwest 11033.662\n85   37 female 34.800        2    yes southwest 39836.519\n86   45   male 22.895        2    yes northwest 21098.554\n87   57 female 31.160        0    yes northwest 43578.939\n88   56 female 27.200        0     no",
        " southwest 11073.176\n89   46 female 27.740        0     no northwest  8026.667\n90   55 female 26.980        0     no northwest 11082.577\n91   21 female 39.490        0     no southeast  2026.974\n92   53 female 24.795        1     no northwest 10942.132\n93   59   male 29.830        3    yes northeast 30184.937\n94   35   male 34.770        2     no northwest  5729.005\n95   64 female 31.300        2    yes southwest 47291.055\n96   28 female 37.620        1     no southeast  3766.884\n97   54 female 30.800        3",
        "     no southwest 12105.320\n98   55   male 38.280        0     no southeast 10226.284\n99   56   male 19.950        0    yes northeast 22412.648\n100  38   male 19.300        0    yes southwest 15820.699\n101  41 female 31.600        0     no southwest  6186.127\n102  30   male 25.460        0     no northeast  3645.089\n103  18 female 30.115        0     no northeast 21344.847\n104  61 female 29.920        3    yes southeast 30942.192\n105  34 female 27.500        1     no southwest  5003.853\n106  20   male 28.025",
        "        1    yes northwest 17560.380\n107  19 female 28.400        1     no southwest  2331.519\n108  26   male 30.875        2     no northwest  3877.304\n109  29   male 27.940        0     no southeast  2867.120\n110  63   male 35.090        0    yes southeast 47055.532\n111  54   male 33.630        1     no northwest 10825.254\n112  55 female 29.700        2     no southwest 11881.358\n113  37   male 30.800        0     no southwest  4646.759\n114  21 female 35.720        0     no northwest  2404.734\n115  52   male",
        " 32.205        3     no northeast 11488.317\n116  60   male 28.595        0     no northeast 30259.996\n117  58   male 49.060        0     no southeast 11381.325\n118  29 female 27.940        1    yes southeast 19107.780\n119  49 female 27.170        0     no southeast  8601.329\n120  37 female 23.370        2     no northwest  6686.431\n121  44   male 37.100        2     no southwest  7740.337\n122  18   male 23.750        0     no northeast  1705.624\n123  20 female 28.975        0     no northwest  2257.475\n124  44",
        "   male 31.350        1    yes northeast 39556.495\n125  47 female 33.915        3     no northwest 10115.009\n126  26 female 28.785        0     no northeast  3385.399\n127  19 female 28.300        0    yes southwest 17081.080\n128  52 female 37.400        0     no southwest  9634.538\n129  32 female 17.765        2    yes northwest 32734.186\n130  38   male 34.700        2     no southwest  6082.405\n131  59 female 26.505        0     no northeast 12815.445\n132  61 female 22.040        0     no northeast 13616.359",
        "\n133  53 female 35.900        2     no southwest 11163.568\n134  19   male 25.555        0     no northwest  1632.564\n135  20 female 28.785        0     no northeast  2457.211\n136  22 female 28.050        0     no southeast  2155.682\n137  19   male 34.100        0     no southwest  1261.442\n138  22   male 25.175        0     no northwest  2045.685\n139  54 female 31.900        3     no southeast 27322.734\n140  22 female 36.000        0     no southwest  2166.732\n141  34   male 22.420        2     no northeast",
        " 27375.905\n142  26   male 32.490        1     no northeast  3490.549\n [ reached 'max' / getOption(\"max.print\") -- omitted 1196 rows ]\n",
        "> ",
        "",
        "> ",
        "## 1.1. Check for Missing Values",
        "> ",
        "insurance_df %>%",
        "+ ",
        "  summarise_all(",
        "+ ",
        "    ~ sum(is.na(.))",
        "+ ",
        "  )",
        "  age sex bmi children smoker region charges\n1   0   0   0        0      0      0       0\n",
        "> ",
        "summary(insurance_df)",
        "      age            sex                 bmi           children    \n Min.   :18.00   Length:1338        Min.   :15.96   Min.   :0.000  \n 1st Qu.:27.00   Class :character   1st Qu.:26.30   1st Qu.:0.000  \n Median :39.00   Mode  :character   Median :30.40   Median :1.000  \n Mean   :39.21                      Mean   :30.66   Mean   :1.095  \n 3rd Qu.:51.00                      3rd Qu.:34.69   3rd Qu.:2.000  \n Max.   :64.00                      Max.   :53.13   Max.   :5.000  \n    smoker             region         ",
        "    charges     \n Length:1338        Length:1338        Min.   : 1122  \n Class :character   Class :character   1st Qu.: 4740  \n Mode  :character   Mode  :character   Median : 9382  \n                                       Mean   :13270  \n                                       3rd Qu.:16640  \n                                       Max.   :63770  \n",
        "> ",
        "",
        "> ",
        "## 1.2. Change Target to Factor",
        "> ",
        "insurance_df <- insurance_df %>%",
        "+ ",
        "  mutate(sex = factor(sex),",
        "+ ",
        "         smoker = factor(smoker),",
        "+ ",
        "         region = factor(region),",
        "+ ",
        "         children = factor(children)",
        "+ ",
        "  ) ",
        "> ",
        "insurance_df",
        "    age    sex    bmi children smoker    region   charges\n1    19 female 27.900        0    yes southwest 16884.924\n2    18   male 33.770        1     no southeast  1725.552\n3    28   male 33.000        3     no southeast  4449.462\n4    33   male 22.705        0     no northwest 21984.471\n5    32   male 28.880        0     no northwest  3866.855\n6    31 female 25.740        0     no southeast  3756.622\n7    46 female 33.440        1     no southeast  8240.590\n8    37 female 27.740        3     no northwest  7281.506",
        "\n9    37   male 29.830        2     no northeast  6406.411\n10   60 female 25.840        0     no northwest 28923.137\n11   25   male 26.220        0     no northeast  2721.321\n12   62 female 26.290        0    yes southeast 27808.725\n13   23   male 34.400        0     no southwest  1826.843\n14   56 female 39.820        0     no southeast 11090.718\n15   27   male 42.130        0    yes southeast 39611.758\n16   19   male 24.600        1     no southwest  1837.237\n17   52 female 30.780        1     no northeast",
        " 10797.336\n18   23   male 23.845        0     no northeast  2395.172\n19   56   male 40.300        0     no southwest 10602.385\n20   30   male 35.300        0    yes southwest 36837.467\n21   60 female 36.005        0     no northeast 13228.847\n22   30 female 32.400        1     no southwest  4149.736\n23   18   male 34.100        0     no southeast  1137.011\n24   34 female 31.920        1    yes northeast 37701.877\n25   37   male 28.025        2     no northwest  6203.902\n26   59 female 27.720        3     no",
        " southeast 14001.134\n27   63 female 23.085        0     no northeast 14451.835\n28   55 female 32.775        2     no northwest 12268.632\n29   23   male 17.385        1     no northwest  2775.192\n30   31   male 36.300        2    yes southwest 38711.000\n31   22   male 35.600        0    yes southwest 35585.576\n32   18 female 26.315        0     no northeast  2198.190\n33   19 female 28.600        5     no southwest  4687.797\n34   63   male 28.310        0     no northwest 13770.098\n35   28   male 36.400        1",
        "    yes southwest 51194.559\n36   19   male 20.425        0     no northwest  1625.434\n37   62 female 32.965        3     no northwest 15612.193\n38   26   male 20.800        0     no southwest  2302.300\n39   35   male 36.670        1    yes northeast 39774.276\n40   60   male 39.900        0    yes southwest 48173.361\n41   24 female 26.600        0     no northeast  3046.062\n42   31 female 36.630        2     no southeast  4949.759\n43   41   male 21.780        1     no southeast  6272.477\n44   37 female 30.800",
        "        2     no southeast  6313.759\n45   38   male 37.050        1     no northeast  6079.672\n46   55   male 37.300        0     no southwest 20630.284\n47   18 female 38.665        2     no northeast  3393.356\n48   28 female 34.770        0     no northwest  3556.922\n49   60 female 24.530        0     no southeast 12629.897\n50   36   male 35.200        1    yes southeast 38709.176\n51   18 female 35.625        0     no northeast  2211.131\n52   21 female 33.630        2     no northwest  3579.829\n53   48   male",
        " 28.000        1    yes southwest 23568.272\n54   36   male 34.430        0    yes southeast 37742.576\n55   40 female 28.690        3     no northwest  8059.679\n56   58   male 36.955        2    yes northwest 47496.494\n57   58 female 31.825        2     no northeast 13607.369\n58   18   male 31.680        2    yes southeast 34303.167\n59   53 female 22.880        1    yes southeast 23244.790\n60   34 female 37.335        2     no northwest  5989.524\n61   43   male 27.360        3     no northeast  8606.217\n62   25",
        "   male 33.660        4     no southeast  4504.662\n63   64   male 24.700        1     no northwest 30166.618\n64   28 female 25.935        1     no northwest  4133.642\n65   20 female 22.420        0    yes northwest 14711.744\n66   19 female 28.900        0     no southwest  1743.214\n67   61 female 39.100        2     no southwest 14235.072\n68   40   male 26.315        1     no northwest  6389.378\n69   40 female 36.190        0     no southeast  5920.104\n70   28   male 23.980        3    yes southeast 17663.144",
        "\n71   27 female 24.750        0    yes southeast 16577.780\n72   31   male 28.500        5     no northeast  6799.458\n73   53 female 28.100        3     no southwest 11741.726\n74   58   male 32.010        1     no southeast 11946.626\n75   44   male 27.400        2     no southwest  7726.854\n76   57   male 34.010        0     no northwest 11356.661\n77   29 female 29.590        1     no southeast  3947.413\n78   21   male 35.530        0     no southeast  1532.470\n79   22 female 39.805        0     no northeast",
        "  2755.021\n80   41 female 32.965        0     no northwest  6571.024\n81   31   male 26.885        1     no northeast  4441.213\n82   45 female 38.285        0     no northeast  7935.291\n83   22   male 37.620        1    yes southeast 37165.164\n84   48 female 41.230        4     no northwest 11033.662\n85   37 female 34.800        2    yes southwest 39836.519\n86   45   male 22.895        2    yes northwest 21098.554\n87   57 female 31.160        0    yes northwest 43578.939\n88   56 female 27.200        0     no",
        " southwest 11073.176\n89   46 female 27.740        0     no northwest  8026.667\n90   55 female 26.980        0     no northwest 11082.577\n91   21 female 39.490        0     no southeast  2026.974\n92   53 female 24.795        1     no northwest 10942.132\n93   59   male 29.830        3    yes northeast 30184.937\n94   35   male 34.770        2     no northwest  5729.005\n95   64 female 31.300        2    yes southwest 47291.055\n96   28 female 37.620        1     no southeast  3766.884\n97   54 female 30.800        3",
        "     no southwest 12105.320\n98   55   male 38.280        0     no southeast 10226.284\n99   56   male 19.950        0    yes northeast 22412.648\n100  38   male 19.300        0    yes southwest 15820.699\n101  41 female 31.600        0     no southwest  6186.127\n102  30   male 25.460        0     no northeast  3645.089\n103  18 female 30.115        0     no northeast 21344.847\n104  61 female 29.920        3    yes southeast 30942.192\n105  34 female 27.500        1     no southwest  5003.853\n106  20   male 28.025",
        "        1    yes northwest 17560.380\n107  19 female 28.400        1     no southwest  2331.519\n108  26   male 30.875        2     no northwest  3877.304\n109  29   male 27.940        0     no southeast  2867.120\n110  63   male 35.090        0    yes southeast 47055.532\n111  54   male 33.630        1     no northwest 10825.254\n112  55 female 29.700        2     no southwest 11881.358\n113  37   male 30.800        0     no southwest  4646.759\n114  21 female 35.720        0     no northwest  2404.734\n115  52   male",
        " 32.205        3     no northeast 11488.317\n116  60   male 28.595        0     no northeast 30259.996\n117  58   male 49.060        0     no southeast 11381.325\n118  29 female 27.940        1    yes southeast 19107.780\n119  49 female 27.170        0     no southeast  8601.329\n120  37 female 23.370        2     no northwest  6686.431\n121  44   male 37.100        2     no southwest  7740.337\n122  18   male 23.750        0     no northeast  1705.624\n123  20 female 28.975        0     no northwest  2257.475\n124  44",
        "   male 31.350        1    yes northeast 39556.495\n125  47 female 33.915        3     no northwest 10115.009\n126  26 female 28.785        0     no northeast  3385.399\n127  19 female 28.300        0    yes southwest 17081.080\n128  52 female 37.400        0     no southwest  9634.538\n129  32 female 17.765        2    yes northwest 32734.186\n130  38   male 34.700        2     no southwest  6082.405\n131  59 female 26.505        0     no northeast 12815.445\n132  61 female 22.040        0     no northeast 13616.359",
        "\n133  53 female 35.900        2     no southwest 11163.568\n134  19   male 25.555        0     no northwest  1632.564\n135  20 female 28.785        0     no northeast  2457.211\n136  22 female 28.050        0     no southeast  2155.682\n137  19   male 34.100        0     no southwest  1261.442\n138  22   male 25.175        0     no northwest  2045.685\n139  54 female 31.900        3     no southeast 27322.734\n140  22 female 36.000        0     no southwest  2166.732\n141  34   male 22.420        2     no northeast",
        " 27375.905\n142  26   male 32.490        1     no northeast  3490.549\n [ reached 'max' / getOption(\"max.print\") -- omitted 1196 rows ]\n",
        "> ",
        "",
        "> ",
        "# 2. Exploratory Data Analysis (EDA)",
        "> ",
        "## 2.1 Insurance Variables",
        "> ",
        "insurance_df %>% ",
        "+ ",
        "  ggplot(aes(charges, ..density.., fill = I(\"#d45087\"))) +",
        "+ ",
        "  geom_histogram(bins = 50) +",
        "+ ",
        "  geom_density()+",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "tibble(low_charges = nrow(filter(insurance_df,charges<15000 )),",
        "+ ",
        "       middle_charges =  nrow(filter(insurance_df,charges>=15000 & charges<50000)),",
        "+ ",
        "       high_charges = nrow(filter(insurance_df, charges>=50000)),",
        "+ ",
        ")",
        "\u001B[90m# A tibble: 1 x 3\u001B[39m\n  low_charges middle_charges high_charges\n        \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m          \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m        \u001B[3m\u001B[90m<int>\u001B[39m\u001B[23m\n\u001B[90m1\u001B[39m         980            351            7\n",
        "> ",
        "",
        "> ",
        "## 2.2 Age Variables",
        "> ",
        "insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, fill = I(\"#d45087\")))+",
        "+ ",
        "  geom_bar()+ ",
        "+ ",
        "  theme(legend.position = \"none\")",
        "> ",
        "",
        "> ",
        "p1 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, charges))+",
        "+ ",
        "  geom_point(color = I(\"#d45087\"))",
        "> ",
        "",
        "> ",
        "p2 <- insurance_df %>% ",
        "+ ",
        "  ggplot(aes(age, charges, color = smoker))+",
        "+ ",
        "  geom_point()",
        "> ",
        "",
        "> ",
        "p1+p2",
        "\nRestarting R session...\n\n"
    ]
}